<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="plotblocksnearby - Map view of Census blocks (their centroids) near one or more sites
Utility to quickly view one or more facility points on map with the blocks found nearby"><title>plotblocksnearby - Map view of Census blocks (their centroids) near one or more sites
Utility to quickly view one or more facility points on map with the blocks found nearby — plotblocksnearby • EJAM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="plotblocksnearby - Map view of Census blocks (their centroids) near one or more sites
Utility to quickly view one or more facility points on map with the blocks found nearby — plotblocksnearby"><meta property="og:description" content="plotblocksnearby - Map view of Census blocks (their centroids) near one or more sites
Utility to quickly view one or more facility points on map with the blocks found nearby"><meta property="og:image" content="https://bookish-disco-p8oe8wq.pages.github.io/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EJAM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Overview for EJAM Users</h6>
    <a class="dropdown-item" href="../articles/0_what_is_ejam.html">What is EJAM?</a>
    <a class="dropdown-item" href="../articles/0_webapp.html">Using EJAM</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>For analysts using R</h6>
    <a class="dropdown-item" href="../articles/1_installing.html">1. Installing the EJAM R package</a>
    <a class="dropdown-item" href="../articles/2_quickstart.html">2. Quick Start Guide</a>
    <a class="dropdown-item" href="../articles/3_analyzing.html">3. Basics of Using EJAM for Analysis in RStudio</a>
    <a class="dropdown-item" href="../articles/4_advanced.html">4. Advanced Features</a>
    <a class="dropdown-item" href="../articles/5_ejscreenapi.html">5. Using the EJScreen API via EJAM</a>
    <a class="dropdown-item" href="../articles/6_future_plans.html">6. Future Plans and Ideas for EJAM</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/EJAM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>plotblocksnearby - Map view of Census blocks (their centroids) near one or more sites
Utility to quickly view one or more facility points on map with the blocks found nearby</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/EJAM/blob/HEAD/R/plotblocksnearby.R" class="external-link"><code>R/plotblocksnearby.R</code></a></small>
      <div class="d-none name"><code>plotblocksnearby.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>plotblocksnearby - Map view of Census blocks (their centroids) near one or more sites
Utility to quickly view one or more facility points on map with the blocks found nearby</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotblocksnearby</span><span class="op">(</span></span>
<span>  <span class="va">sitepoints</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  <span class="va">sites2blocks</span>,</span>
<span>  siteidvarname <span class="op">=</span> <span class="st">"ejam_uniq_id"</span>,</span>
<span>  usemapfast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnmap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overlay_blockgroups <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  maxradius <span class="op">=</span> <span class="fl">31.07</span>,</span>
<span>  avoidorphans <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>sitepoints</dt>
<dd><p>table of points with lat, lon in decimal degrees (data.frame or data.table),
but also could just be the output of getblocksnearby() if that has already been done.</p></dd>


<dt>radius</dt>
<dd><p>optional. in miles (Max allowed is 32 miles, or just over 50 kilometers since 31.06856 miles is 50 * 1000 / meters_per_mile).</p></dd>


<dt>sites2blocks</dt>
<dd><p>optional. If provided, used as sites2blocks like <a href="testoutput_getblocksnearby_10pts_1miles.html">testoutput_getblocksnearby_10pts_1miles</a>
If neither sites2blocks nor sitepoints is provided it cannot plot and returns error.
If sites2blocks and sitepoints are both provided, it uses them both to plot blocks and sites (centers of circles).
If sites2blocks not provided, but sitepoints alone is provided, checks if sitepoints is actually sites2blocks, and uses as such.
If sites2blocks not provided, but sitepoints alone is provided, and sitepoints is really sitepoints, it runs getblocksnearby() to create sites2blocks.
If sites2blocks is provided, but sitepoints is not, it could only do a bad approximation of sitepoints so it will not draw the circle or site at center of the circle.</p></dd>


<dt>siteidvarname</dt>
<dd><p>optional. specifies the column name in sites2blocks that is the unique site id, the values of which should
also be the row numbers of the corresponding sites in sitepoints, with a site appearing once in sitepoints,
and in sites2blocks appearing once per block that is near that site.</p></dd>


<dt>usemapfast</dt>
<dd><p>optional. simpler plot if FALSE</p></dd>


<dt>returnmap</dt>
<dd><p>optional. if set TRUE, returns the leaflet map object instead of tabular info.
That  is needed to pass results to map_blockgroups_over_blocks() for example.</p></dd>


<dt>overlay_blockgroups</dt>
<dd><p>optional. if set TRUE, also plots overlay of blockgroup boundaries.</p></dd>


<dt>maxradius</dt>
<dd><p>optional. see <code><a href="getblocksnearby.html">getblocksnearby()</a></code></p></dd>


<dt>avoidorphans</dt>
<dd><p>optional. see <code><a href="getblocksnearby.html">getblocksnearby()</a></code></p></dd>


<dt>...</dt>
<dd><p>optional. passed to mapfast() or plot() depending on usemapfast,
like column_names = "ej" for better map popups on block points</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>invisibly returns sites2blocks like getblocksnearby() does</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Uses <code><a href="getblocksnearby.html">getblocksnearby()</a></code> if lat,lon points provided as sitepoints,
but skips it if looks like user passed output of getblocksnearby(),
and then displays a map of those blocks near the specified point.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co">#  see all Census Blocks within 1 mile of 1 site, if already had run getblocksnearby()</span></span></span>
<span class="r-in"><span>  <span class="va">getblocks_output</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="va">testoutput_getblocksnearby_10pts_1miles</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in copy(testoutput_getblocksnearby_10pts_1miles):</span> could not find function "copy"</span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="st">"siteid"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">getblocks_output</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">siteidvarname</span> <span class="op">&lt;-</span> <span class="st">"siteid"</span> <span class="co"># the old default</span></span></span>
<span class="r-in"><span>  <span class="va">eg</span> <span class="op">&lt;-</span> <span class="va">getblocks_output</span><span class="op">[</span><span class="va">siteid</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">eg2</span> <span class="op">&lt;-</span> <span class="va">getblocks_output</span><span class="op">[</span><span class="va">siteid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">10</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">siteidvarname</span> <span class="op">&lt;-</span> <span class="st">"ejam_uniq_id"</span></span></span>
<span class="r-in"><span>   <span class="va">eg</span> <span class="op">&lt;-</span> <span class="va">getblocks_output</span><span class="op">[</span><span class="va">ejam_uniq_id</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>   <span class="va">eg2</span> <span class="op">&lt;-</span> <span class="va">getblocks_output</span><span class="op">[</span><span class="va">ejam_uniq_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">10</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in "siteid" %in% names(getblocks_output):</span> object 'getblocks_output' not found</span>
<span class="r-in"><span>   <span class="va">z</span> <span class="op">&lt;-</span>  <span class="fu">plotblocksnearby</span><span class="op">(</span>sitepoints <span class="op">=</span> <span class="va">testpoints_10</span>, </span></span>
<span class="r-in"><span>     sites2blocks <span class="op">=</span> <span class="va">eg</span>, radius <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in NROW(sites2blocks):</span> object 'eg' not found</span>
<span class="r-in"><span>   <span class="co"># see two sites if already had run getblocksnearby()</span></span></span>
<span class="r-in"><span>   <span class="va">z2</span> <span class="op">&lt;-</span>  <span class="fu">plotblocksnearby</span><span class="op">(</span>sitepoints <span class="op">=</span> <span class="va">testpoints_10</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">10</span><span class="op">)</span>,<span class="op">]</span>, </span></span>
<span class="r-in"><span>     sites2blocks <span class="op">=</span> <span class="va">eg2</span>, radius <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in NROW(sites2blocks):</span> object 'eg2' not found</span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># See one randomly selected regulated facility from FRS and all Census Blocks within 2 miles:</span></span></span>
<span class="r-in"><span>    <span class="fu">plotblocksnearby</span><span class="op">(</span><span class="fu"><a href="testpoints_n.html">testpoints_n</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="co"># See two sites and all Census Blocks within 5 kilometers</span></span></span>
<span class="r-in"><span>    <span class="fu">plotblocksnearby</span><span class="op">(</span><span class="va">testpoints_2</span>, radius <span class="op">=</span> <span class="fu"><a href="convert_units.html">convert_units</a></span><span class="op">(</span><span class="fl">5</span>, from <span class="op">=</span> <span class="st">"km"</span>, towhat <span class="op">=</span> <span class="st">"miles"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># See 100 sites and all blocks within 1 mile of each - </span></span></span>
<span class="r-in"><span>  <span class="co"># Note you have to specify radius here or it uses default that may not match intent </span></span></span>
<span class="r-in"><span>  <span class="co"># - and this is a bit slow</span></span></span>
<span class="r-in"><span>  <span class="fu">plotblocksnearby</span><span class="op">(</span><span class="va">testoutput_ejamit_100pts_1miles</span><span class="op">$</span><span class="va">results_bysite</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">siteidvarname</span>, <span class="st">"lat"</span>, <span class="st">"lon"</span><span class="op">)</span>, with<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     radius <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>DRAFT</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>EJAM Version 2.2.1 beta</p>
</div>

    </footer></div>

  

  

  </body></html>

